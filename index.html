<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>pstuffa</title>

    <script src="./shared/js/vendor/d3/d3.min.js"></script>
    <link href="./shared/css/welcome.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Crete+Round|Pacifico" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Special+Elite" rel="stylesheet">
  <body>

    <div id="welcome">
    </div>
    <div id="titles">
      <h1 class='title'> Paul Buffa </h1>
      <h3 class='sub-title'> Data Visualization Developer </h3>
      <p class='contact'> Contact me on <a href='https://www.linkedin.com/in/paul-buffa/'>LinkedIn</a> or <a href='https://twitter.com/pstuffa'>Twitter</a> </p> 
      <p class='scroll'> Scroll down for examples of my work</p>
    </div>
    <div id="gifs">
      <h2 class='project-title'> Hover over for more details </h2>
    </div>
  </body>

</html>

<script>

const margin = ({top: 20, bottom: 20, left: 20, right: 20})
const height = window.innerHeight 
let width = window.innerWidth * .9
const multiplier = 6;
const svgHeight = height * multiplier;
const gifHeight = width / 5;
const thickWidth = width / 75;
const thinWidth = thickWidth / 4;

let isMobile = false;
// device detection
if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent) 
    || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))) { 

  isMobile = true;
  width = window.innerWidth * .75

  d3.select("#titles")
    .style("right", "5%")

  d3.select(".title")
    .style("font-size", "36px")

  d3.select(".sub-title")
    .style("font-size", "18px")

  d3.select(".contact")
    .style("font-size", "16px")

  d3.select(".scroll")
    .style("font-size", "16px")

  d3.select(".project-title")
    .style("text-align", "center")
    .text("Tap on a gif")
}


d3.select("#titles").style("top", `${height * (2/4)}px`)

const gifsData = [
  { width: 600, height: 484, src:'./shared/gifs/natgeo.gif', descr: 'A data visualization article I wrote for National Geographic about tracking immigrant community integration using Twitter data. I designed and built the visualization and wrote the copy for the piece.', title: 'National Geographic', link: 'https://www.nationalgeographic.com/culture/2018/09/researchers-using-twitter-data-immigration-migration-graphic/'},
  { width: 600, height: 304, src:'./shared/gifs/streeteasy.gif', descr: 'A tool I made in collaboration with Streeteasy for potentional homeowners to see how long they buy a home until they will break even with their investment. We visualize the cost of homeownership agaisnt property vale appreciation. Users can select different neighborhoods to see specific results.', title: 'Streeteasy', link: 'https://streeteasy.com/tippingpoint'},
  { width: 700, height: 538, src:'./shared/gifs/550.gif', descr: 'A project I am working on that takes multiple open source datasets and combines them to paint a picture of how condominiums sell their apartments. The visualization plays an animation showing the progress of sales for a particular building.', title: 'Apartment Analysis', link: 'https://beta.observablehq.com/@pstuffa/550-vanderbilt'},
  { width: 400, height: 288, src:'./shared/gifs/prospect.gif', descr: 'A visualization of building permits issued in Prospect Heights, a neighborhood in Brooklyn. The goal of this visaulization is to test the building permit API by NYC Open Data and title vector maps.', title: 'Prospect Heights', link: 'https://beta.observablehq.com/@pstuffa/nyc-building-permits-api-prospect-heights/2'},
  { width: 500, height: 437, src:'./shared/gifs/jiggle.gif', descr: 'I taught a two part workshop at ITP, an NYU program, on how to do data visualization with D3.js. This is one of the notebooks we went through in the class. It goes over how to make contour density maps with D3 and Census data. ', title: 'ITP Workshop', link: 'https://beta.observablehq.com/@pstuffa/making-maps-with-nyc-open-data'},
  { width: 500, height: 298, src:'./shared/gifs/run.gif', descr: "I am an avid runner, and I've done several visaulization on running data. This is the first part of a series that explores how to best visualize a run.", title: 'Visualizing Running - Part I', link: 'https://beta.observablehq.com/@pstuffa/visualizing-running-part-i'},
  { width: 1000, height: 612, src:'./shared/gifs/run4.gif', descr: 'Part six of my series on visaulizing running, this piece explores ways of comparing heart rate data across several training runs to better see how one improves consistency in heart rate.', title: 'Visualizing Running - Part VI', link: 'https://beta.observablehq.com/@pstuffa/visualizing-running-part-vi'},
  { width: 1000, height: 859, src:'./shared/gifs/run6.gif', descr: 'Part five of my series on visualizing running, I take an attempt at improving the map visualizations that are so often used in running aps. ', title: 'Visualizing Running - Part V', link: 'https://beta.observablehq.com/@pstuffa/visualizing-running-part-v'},
  { width: 500, height: 365, src:'./shared/gifs/run5.gif', descr: 'Part seven of my series on visualizing running, this piece tries to tackle comparing both heart rate and pace for training runs over time. Each run is visualized as an area chart that on the top represents heart rate and the bottom pace.', title: 'Visualizing Running - Part VII', link: 'https://beta.observablehq.com/@pstuffa/visualizing-running-part-vii'},
  { width: 600, height: 600, src:'./shared/gifs/process.gif', descr: 'A recreation in D3 of Op Art by Jean-Pierre Vasarely, aka Yvaral', title: 'Yvaral', link: 'https://beta.observablehq.com/@pstuffa/yvaral-in-d3'},
  { width: 400, height: 400, src:'./shared/gifs/yvaralswave.gif', descr: 'Another recreation in D3 of Op Art by Jean-Pierre Vasarely, aka Yvaral', title: 'Yvaral II', link: 'https://beta.observablehq.com/@pstuffa/yvaral-ii'},
  { width: 500, height: 224, src:'./shared/gifs/morphing.gif', descr: 'An exploration for how to create inkblots using D3', title: 'Rorschach Tests', link: 'https://beta.observablehq.com/@pstuffa/making-inkblots-in-d3'},
  { width: 500, height: 461, src:'./shared/gifs/noisey.gif', descr: 'An exploration into recreating the famous piece by Bridget Riley, Blaze 1964', title: 'Bridget Riley', link: 'https://beta.observablehq.com/@pstuffa/bridget-riley'}
]

const generateData = (n) => {

  const points = d3.range(n).map(Object);

  points.forEach((d, i) => {
    if(Math.floor(i/3) % 2 == 0) {
      if(i % 3 == 1) {
        d.x = .0
      } else if (i % 3 == 2) {
        d.x = .5
      } else {
        d.x = .5
      }
      d.y = i;
    } else {
      if(i % 3 == 1) {
        d.y = .0
      } else if (i % 3 == 2) {
        d.y = .5
      } else {
        d.y = .5
      }
      d.x = i;
    }
  })

  return points
}

 const n = 50;
 const data = generateData(n);
 data.unshift({x: -.25, y: -10});
 data.push({x: .5, y: n });
 data.push({x: .5, y: n * (multiplier + 5)});
  
 const heightScale = d3.scaleLinear()
    .domain([0, n])
    .range([0, height]);
  
 const widthScale = d3.scaleLinear()
    .domain([0, n])
    .range([0, width]);
  
 const line = d3.line()
   .curve(d3.curveBasis)
   .x(d => widthScale(d.x))
   .y(d => heightScale(d.y));
 
 const svg = d3.select("#welcome")
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", svgHeight + margin.top + margin.bottom)

  const g = svg.append("g")
    .attr("transform",`translate(${margin.left}, ${margin.top})`)

  const pathTwo = g.append("path")
   .datum(data)
   .attr("d", line)
   .style("stroke", '#000')
   .style("stroke-width", thickWidth)
   .style("fill", "none")
  
 const path = g.append("path")
   .datum(data)
   .attr("d", line)
   .style("stroke", '#33ccff')
   .style("stroke-width", thinWidth)
   .style("fill", "none")
        .attr("stroke-dasharray",  `${width / 2} ${width / 2} 10 10 10 10 10 10 10 10` )
        .attr("stroke-dashoffset", width)
 
  let strokeOffset = 0;
  const t = d3.interval(function() {
    strokeOffset -= 1
    path.transition()
      .duration(1)
      .style("stroke-dashoffset", strokeOffset)
  }, 10)


  // Projects 
  const gifContainer = d3.select("#gifs")
    .style("top",`${margin.top + height + (isMobile ? -50 : 50)}px`)
    .style("max-width", `${width}px`)


if(isMobile) {

  const gifGroup = gifContainer.selectAll(".gif-group")
    .data(gifsData)
  .enter().append("div")
    .attr("class", "gif-group")
    .style("height", d =>`${d.height / (d.width / width)}px`)
    .style("width", `${width}px`)
    .on("touchstart", function() {
      d3.select(this).select(".hover-text")
        .transition()
        .style("opacity", .85)
    })
    .on("touchmove", function() {
      d3.select(this).select(".hover-text")
        .transition()
        .style("opacity", 0)
    })

  gifGroup.append("img")
      .attr("src", d => d.src)
      .attr("height", d =>`${d.height / (d.width / width)}px`)
      .attr("width", `${width}px`)
    
  gifGroup.append("div")
      .style("width", `${width}px`)
      .style("max-width", `${width}px`)
      .style("height", d =>`${d.height / (d.width / width)}px`)
      .style("background-color", "#000")
      .style("opacity", 0)
      .attr("class", "hover-text")
      .html(d => { return `<h5 class='tiny-title'>${d.title}</h5><br /><p>${d.descr}</p><a href='${d.link}'>Click here to see the work </a>`})

} else {

  const gifGroup = gifContainer.selectAll(".gif-group")
    .data(gifsData)
  .enter().append("div")
    .attr("class", "gif-group")
    .style("width", d => `${d.width / (d.height / gifHeight)}px`)
    .style("height", `${gifHeight}px`)
    .on("mouseenter", function() {
      d3.select(this).select(".hover-text")
        .transition()
        .style("opacity", .85)
    })
    .on("mouseleave", function() {
      d3.select(this).select(".hover-text")
        .transition()
        .style("opacity", 0)
    })

  gifGroup.append("img")
      .attr("src", d => d.src)
      .attr("height", `${gifHeight}px`)
      .attr("width", d => `${d.width / (d.height / gifHeight)}px`)
    
  gifGroup.append("div")
      .style("width", d => `${d.width / (d.height / gifHeight)}px`)
      .style("max-width", d => `${d.width / (d.height / gifHeight)}px`)
      .style("height", `${gifHeight}px`)
      .style("background-color", "#000")
      .style("opacity", 0)
      .attr("class", "hover-text")
      .html(d => { return `<h5 class='tiny-title'>${d.title}</h5><br /><p>${d.descr}</p><br /><br /><a href='${d.link}'>Click here to see the work </a>`})

}

</script>